# ASX Stocks Daily Analysis - Template Orchestration Job
# This job runs stock analysis for multiple stocks, then emails each report individually.
#
# WORKFLOW:
# 1. Run asx-stock-review template for each stock (parallel analysis)
# 2. Run stock-email-report template for each stock (sends individual emails)
#
# VARIABLES:
# Global variables are declared once at job level in [config] section.
# Both steps inherit these variables automatically.

id = "asx-stocks-daily"
name = "ASX Daily Stock Analysis (Multiple Stocks)"
type = "job_template"
description = "Runs ASX stock analysis template for configured stocks with individual emails"
tags = ["asx", "stocks", "daily", "template", "email"]
schedule = ""
timeout = "2h"
enabled = true
auto_start = false

# Global variables - inherited by all steps that use job_template
# Available variable keys: ticker, name, industry
# Variable references in templates: {stock:ticker}, {stock:name}, {stock:industry}
# Modifiers: {stock:ticker_lower}, {stock:ticker_upper}
[config]
variables = [
    { ticker = "GNP", name = "GenusPlus Group Ltd", industry = "infrastructure" },
    { ticker = "CBA", name = "Commonwealth Bank", industry = "banking" },
    { ticker = "WES", name = "Wesfarmers", industry = "retail" },
    { ticker = "EXR", name = "Elixir Energy", industry = "energy" },
    { ticker = "SRL", name = "Sunrise Energy Metals", industry = "mining" },
    { ticker = "ROC", name = "RocketBoots Limited", industry = "AI" },
]

[step.run_stock_analysis]
type = "job_template"
description = "Execute stock analysis template for each configured stock"
on_error = "continue"
template = "asx-stock-review"
parallel = true
# Variables inherited from [config] section

[step.email_stock_reports]
type = "job_template"
description = "Email individual stock analysis reports"
depends = "run_stock_analysis"
on_error = "continue"
template = "stock-email-report"
parallel = true
# Variables inherited from [config] section
