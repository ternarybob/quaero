# Navexa Portfolio Review - Orchestrated Version
# =========================================================================
# Uses goal_template to reference reusable analysis script.
# Portfolios are discovered automatically via Navexa API.
#
# TEMPLATE: job-templates/navexa-portfolio-analysis-goal.toml
# Contains: goal, tools, thinking_level, output_tags
#
# THIS FILE: Job execution configuration
# Contains: schedule, timeout, email settings
#
# REQUIREMENTS:
# - navexa_api_key in KV storage (set via .env or API)
# - Email SMTP configured for notifications
# =========================================================================

id = "navexa-portfolio-daily-orchestrated"
name = "Navexa Portfolio Review (Thinking)"
type = "orchestrator"
description = "AI-powered portfolio analysis using Navexa data"
tags = ["navexa", "portfolio", "daily", "orchestrator", "thinking"]
schedule = ""
timeout = "3h"
enabled = true
auto_start = false

# =========================================================================
# Configuration
# =========================================================================

[config]
# No variables needed - portfolios are fetched from Navexa API
# The API key is read from KV storage (navexa_api_key)

# =========================================================================
# Orchestrator Step - References Goal Template
# =========================================================================

[step.portfolio_review]
type = "orchestrator"
description = "AI-powered Navexa portfolio review"
on_error = "continue"

# Reference the goal template (contains goal, tools, thinking_level, output_tags)
goal_template = "navexa-portfolio-analysis-goal"

# =========================================================================
# Email Step - Send Portfolio Report
# =========================================================================

[step.email_report]
type = "email"
description = "Email Navexa portfolio review"
depends = "portfolio_review"
always_run = true
on_error = "fail"
to = "bobmcallan@gmail.com"
subject = "Navexa Portfolio Review - AI-Powered Analysis"
body_from_tag = "navexa-portfolio-review"
