{
  "id": "smsf-portfolio-analysis-goal",
  "name": "SMSF Portfolio Analysis Goal Template",
  "type": "orchestrator_template",
  "description": "Reusable goal and tools for AI-powered SMSF portfolio analysis",
  "template": {
    "thinking_level": "HIGH",
    "model_preference": "auto",
    "output_tags": ["smsf-portfolio-review"],
    "output_schema_ref": "portfolio-review.schema.json",
    "available_tools": [
      {
        "name": "fetch_stock_data",
        "description": "Fetch ASX stock prices, historical data, and technical indicators. Creates document tagged with ['asx-stock-data', '<ticker>']. REQUIRED params: asx_code (string). OPTIONAL: period (string) - M1, M3, M6, Y1, Y2, Y5 (default Y1). Use period=Y5 for 5-year historical analysis. Provides: current price, OHLCV history, SMA20/50/200, RSI14, support/resistance, period performance.",
        "worker": "asx_stock_data"
      },
      {
        "name": "fetch_announcements",
        "description": "Fetch official ASX company announcements with price sensitivity flags. Creates document tagged with ['asx-announcement', '<ticker>']. REQUIRED params: asx_code (string). OPTIONAL: period (string) - D1, W1, M1, M3, M6, Y1, Y5 (default Y1). Use for FY/HY results, trading updates, contracts.",
        "worker": "asx_announcements"
      },
      {
        "name": "fetch_index_data",
        "description": "Fetch ASX index data for benchmarks (XJO, XSO). Creates document tagged with ['asx-index', '<code>', 'benchmark']. REQUIRED params: asx_code (string) - e.g. 'XJO', 'XSO'. Provides: current value, period performance, OHLCV history, technicals.",
        "worker": "asx_stock_data"
      },
      {
        "name": "search_web",
        "description": "Search web for financial news, analyst reports, and company research. Creates document tagged with ['web-search']. REQUIRED params: query (string). Use for: analyst coverage, broker notes, competitor analysis.",
        "worker": "web_search"
      },
      {
        "name": "analyze_summary",
        "description": "Generate deep LLM-based analysis from collected documents. REQUIRED params: prompt (string) - analysis instructions, filter_tags (array) - tags to filter documents. OPTIONAL: thinking_level (string) - LOW or HIGH. Use HIGH for portfolio P/L calculations and recommendations.",
        "worker": "summary"
      }
    ],
    "goal": "Perform a comprehensive SMSF portfolio review for all holdings in the variables list.\n\nIMPORTANT: The portfolio may contain 1 or more stocks. Adjust analysis appropriately:\n- For single-stock portfolios: Focus on that stock's performance and risk concentration\n- For multi-stock portfolios: Include diversification and correlation analysis\n\n=== PHASE 1: DATA COLLECTION ===\n\n1. STOCK DATA: For EACH holding in variables:\n   - Use fetch_stock_data with period: Y5 for 5-year historical data\n   - Captures: current price, OHLCV history, technical indicators, period performance\n\n2. ANNOUNCEMENTS: For EACH holding:\n   - Use fetch_announcements with period: Y1 for annual announcements\n   - Captures: FY/HY results, trading updates, material contracts\n\n3. BENCHMARK DATA:\n   - Fetch ASX 200 (XJO) for large cap comparison\n   - Fetch Small Ords (XSO) for small cap comparison\n\n4. NEWS: Search for financial news on each holding\n   - Use search_web for analyst coverage, broker notes\n\n=== PHASE 2: PROFIT & LOSS ANALYSIS ===\n\n5. PORTFOLIO VALUATION (for EACH holding):\n   - Current Price: from stock data\n   - Cost Basis: Units × Avg Purchase Price (from variables)\n   - Current Value: Units × Current Price\n   - Unrealized P/L: Current Value - Cost Basis\n   - Return %: (Current Value - Cost Basis) / Cost Basis × 100\n   - Contribution: Holding's % of total portfolio gain/loss\n\n6. TOTAL PORTFOLIO P/L:\n   - Sum of all Cost Bases = Total Investment\n   - Sum of all Current Values = Total Portfolio Value\n   - Total Unrealized P/L = Total Value - Total Investment\n   - Overall Return % = Total P/L / Total Investment × 100\n\n=== PHASE 3: PORTFOLIO MIX ANALYSIS ===\n\n7. DIVERSIFICATION ASSESSMENT:\n   - Industry concentration: % in each industry/sector\n   - Single-stock risk: Flag any holding >20% of portfolio\n   - Sector correlation: How holdings might move together\n   - For single-stock portfolio: Emphasize concentration risk\n\n8. COMPANY QUALITY ASSESSMENT (for EACH holding):\n   - Revenue trajectory (growing/stable/declining)\n   - Profit trajectory (NPAT/margin trends)\n   - Quality Grade: A (excellent) / B (good) / C (average) / D (weak) / F (speculative)\n\n9. PORTFOLIO MIX RATING:\n   - DEFENSIVE: % in ETFs, bonds, cash, blue chips\n   - GROWTH: % in small caps, technology, emerging\n   - INCOME: Dividend yield of portfolio\n   - Risk Profile: Conservative / Balanced / Aggressive\n\n=== PHASE 4: RECOMMENDATIONS ===\n\n10. DUAL RECOMMENDATIONS (for EACH holding):\n\n    TRADER VIEW (1-6 weeks):\n    - Focus: Technical momentum, near-term catalysts\n    - Action: STRONG BUY / BUY / HOLD / SELL / STRONG SELL\n    - Conviction: 1-10\n\n    SUPER VIEW (6-12+ months):\n    - Focus: Company quality, long-term value, SMSF suitability\n    - Action: ACCUMULATE / HOLD / REDUCE / AVOID\n    - Conviction: 1-10\n    - Only recommend ACCUMULATE for Quality A or B companies\n\n11. PORTFOLIO ACTIONS:\n    - Rebalancing recommendations if any holding drifted from target weight\n    - Add/trim suggestions based on quality and valuation\n    - SMSF compliance notes (diversification rules, arm's length requirements)\n\n=== PHASE 5: SYNTHESIS ===\n\nIf data is missing for any stock:\n- Calculate what you can with available data\n- Note missing data explicitly\n- Continue with remaining analysis\n\nFINAL OUTPUT MUST INCLUDE:\n\n1. PORTFOLIO VALUATION TABLE:\n   Ticker | Units | Avg Cost | Current | Value | P/L | Return% | Weight\n\n2. TOTAL PORTFOLIO SUMMARY:\n   - Total Investment, Current Value, Total P/L, Overall Return %\n\n3. RECOMMENDATIONS TABLE:\n   Ticker | Quality | Trader Rec | Trader Conv | Super Rec | Super Conv\n\n4. PORTFOLIO MIX SUMMARY:\n   - Industry breakdown, Risk profile, Diversification score\n\n5. PRIORITY ACTIONS:\n   - Trader opportunities (1-6 weeks)\n   - Super accumulation targets (6-12+ months)\n   - Rebalancing needs\n\n6. RISK ALERTS:\n   - Overconcentration warnings\n   - Quality concerns (D/F rated holdings)\n   - Stocks at technical extremes"
  }
}
