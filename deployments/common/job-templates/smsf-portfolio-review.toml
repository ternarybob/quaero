# SMSF Portfolio Review Job Template
# =========================================================================
# Senior Investment Strategist analysis for aggressive SMSF portfolios
#
# STRATEGY PRINCIPLES:
# - Aggressive Growth Focus: High-growth potential, capital appreciation
# - Data-Driven Decisions: 12-24 month stock data with announcements
# - Competitor Analysis: Industry outlook and competitive positioning
# - SMSF Compliance: ATO guidelines, concentration risk awareness
#
# USAGE:
# This template is designed to be invoked via a job_template step with variables:
#   variables = [
#     { ticker = "ROC", name = "RocketBoots Limited", industry = "AI" },
#     { ticker = "XRO", name = "Xero Limited", industry = "technology" }
#   ]
#
# VARIABLE SYNTAX:
# - {stock:ticker} - ASX ticker code (e.g., ROC)
# - {stock:name} - Company name
# - {stock:industry} - Industry classification
# - {stock:ticker_lower} - Lowercase ticker for URLs/tags
# =========================================================================

id = "smsf-review-{stock:ticker_lower}"
name = "SMSF Portfolio Review: ASX:{stock:ticker}"
type = "stock_analysis"
description = "Senior Investment Strategist analysis for {stock:name} (ASX:{stock:ticker}) - Aggressive SMSF portfolio assessment"
tags = ["smsf", "aggressive", "asx", "portfolio", "{stock:ticker_lower}", "{stock:industry}"]
schedule = ""
timeout = "30m"
enabled = true
auto_start = false

# =========================================================================
# Step 1: Research Aggressive SMSF Investment Strategy
# =========================================================================
# Collects current information on aggressive growth investing for SMSFs
# to inform the analysis framework with up-to-date strategy guidance.

[step.research_smsf_strategy]
type = "web_search"
description = "Research aggressive SMSF investment strategies and high-growth ASX opportunities"
on_error = "continue"
api_key = "{google_gemini_api_key}"
query = """Aggressive SMSF investment strategy Australia:
- high growth ASX stocks capital appreciation
- sector disrupting companies ASX small caps mid caps
- growth vs value investing SMSF
- ASX high growth sectors technology healthcare resources
- SMSF investment strategy aggressive allocation"""
output_tags = ["smsf-strategy", "{stock:ticker_lower}"]
depth = 3
breadth = 4

# =========================================================================
# Step 2: Collect Daily Stock Data (24 Months)
# =========================================================================
# Fetches comprehensive historical OHLCV data and technical indicators.
# Data is stored as CSV within the document for quantitative analysis.

[step.fetch_stock_data]
type = "asx_stock_data"
description = "Fetch 24-month daily stock data and technicals for {stock:name}"
depends = "research_smsf_strategy"
on_error = "continue"
asx_code = "{stock:ticker}"
period = "Y2"
output_tags = ["{stock:ticker_lower}", "smsf-stock-data", "{stock:industry}"]

# =========================================================================
# Step 3: Collect Company Announcements & Financial Performance
# =========================================================================
# Fetches official ASX announcements to extract financial performance,
# earnings releases, and material events for fundamental analysis.

[step.fetch_announcements]
type = "asx_announcements"
description = "Fetch ASX announcements for {stock:name} fundamental analysis"
depends = "fetch_stock_data"
on_error = "continue"
asx_code = "{stock:ticker}"
period = "Y2"
limit = 50
output_tags = ["{stock:ticker_lower}", "smsf-announcements", "{stock:industry}"]

# =========================================================================
# Step 4: Search for Financial News and Analyst Coverage
# =========================================================================
# Web search for analyst ratings, financial news, and growth catalysts.

[step.search_financial_news]
type = "web_search"
description = "Search financial news, analyst coverage, and growth catalysts for {stock:name}"
depends = "fetch_announcements"
on_error = "continue"
api_key = "{google_gemini_api_key}"
query = """ASX:{stock:ticker} {stock:name}
- earnings growth revenue expansion profit margins
- analyst ratings broker recommendations price targets
- growth catalysts expansion plans market opportunities
- capital raising funding growth initiatives
site:afr.com OR site:theaustralian.com.au OR site:stockhead.com.au OR site:marketindex.com.au"""
output_tags = ["{stock:ticker_lower}", "smsf-financial-news", "{stock:industry}"]
depth = 3
breadth = 3

# =========================================================================
# Step 5: Industry Analysis & Competitive Positioning
# =========================================================================
# Research industry outlook, competitive dynamics, and company positioning.

[step.industry_analysis]
type = "web_search"
description = "Analyze {stock:industry} industry outlook and {stock:name} competitive positioning"
depends = "search_financial_news"
on_error = "continue"
api_key = "{google_gemini_api_key}"
query = """Australia {stock:industry} industry:
- {stock:name} competitors market share positioning
- {stock:industry} sector outlook 2025 2026 growth trends
- {stock:industry} industry disruptors innovation leaders
- ASX {stock:industry} stocks comparison growth potential
site:ibisworld.com OR site:afr.com OR site:asx.com.au"""
output_tags = ["{stock:ticker_lower}", "smsf-industry-analysis", "{stock:industry}"]
depth = 3
breadth = 3

# =========================================================================
# Step 6: Generate Aggressive Growth Stock Summary
# =========================================================================
# Creates a comprehensive summary document focused on aggressive growth
# metrics, identifying laggards and over-performers.

[step.generate_stock_summary]
type = "summary"
description = "Generate aggressive growth summary for {stock:name} identifying laggards vs over-performers"
depends = "industry_analysis"
on_error = "fail"
filter_tags = ["{stock:ticker_lower}"]
api_key = "{google_gemini_api_key}"
prompt = """You are a Senior Investment Strategist specializing in Australian Self-Managed Super Funds (SMSFs).
Your goal is to conduct a rigorous, data-driven review of an aggressive, 100% Australian Equities portfolio.

Analyze all collected data for ASX:{stock:ticker} ({stock:name}) in the {stock:industry} sector.

## CURRENT POSITION REVIEW

### Company Overview
- Company: {stock:name} (ASX:{stock:ticker})
- Industry: {stock:industry}
- Classification: [Large Cap / Mid Cap / Small Cap / Micro Cap]
- Brief description and business model

### Performance Classification
Based on the 12-24 month stock data, classify this holding as:

**LAGGARD** (Underperforming) | **PERFORMING** (Meeting expectations) | **OVER-PERFORMER** (Exceeding expectations)

Justification: [Cite specific metrics from stock data - price change %, RSI, SMA alignment]

## FUNDAMENTAL ANALYSIS

### Financial Metrics (from announcements and news)
| Metric | Value | Trend | Signal |
|--------|-------|-------|--------|
| Revenue Growth | % | Accelerating/Stable/Declining | |
| Earnings Growth | % | Accelerating/Stable/Declining | |
| Profit Margins | % | Expanding/Stable/Contracting | |
| Debt Level | | Low/Moderate/High | |
| Cash Position | | Strong/Adequate/Weak | |

### Key Announcements Impact
- Earnings/Dividends: [Impact assessment]
- Leadership Changes: [Impact assessment]
- Strategic Initiatives: [Impact assessment]
- Capital Raising: [Impact assessment]

## CONTEXTUAL ANALYSIS

### Competitor Landscape
| Competitor | Relative Performance | Threat Level |
|------------|---------------------|--------------|
| [Name] | Outperforming/Matching/Underperforming | High/Medium/Low |

### Industry Outlook
- **Mining Cycle Position** (if applicable): [Early/Mid/Late cycle]
- **Interest Rate Impact** (for banks/REITs): [Positive/Neutral/Negative]
- **Industry Growth Rate**: [Above/At/Below GDP growth]
- **Disruption Risk**: [High/Medium/Low]

## AGGRESSIVE STRATEGY ALIGNMENT

### Growth Potential Assessment
| Factor | Score (1-5) | Evidence |
|--------|-------------|----------|
| High-Growth Potential | | |
| Capital Appreciation Upside | | |
| Sector Disruption Potential | | |
| Management Execution | | |
| Competitive Moat | | |

**TOTAL AGGRESSIVE FIT SCORE**: X/25

### Alignment Verdict
Does {stock:ticker} fit an aggressive, growth-focused SMSF strategy?
[YES - High fit] | [PARTIAL - Some alignment] | [NO - Misaligned]

Justification: [Specific reasons based on data]

---
IMPORTANT:
- Use ONLY data from the provided documents
- If data unavailable, mark as "N/A" and explain
- Be objective - prioritize growth metrics for aggressive strategy"""
output_tags = ["smsf-summary", "{stock:ticker_lower}", "{stock:industry}"]

# =========================================================================
# Step 7: Generate BUY | SELL | HOLD Recommendation with Conviction
# =========================================================================
# Final analysis with conviction scoring, detailed justifications,
# alternative suggestions, and SMSF compliance notes.

[step.investment_recommendation]
type = "summary"
description = "Generate BUY/SELL/HOLD recommendation with conviction score for {stock:name}"
depends = "generate_stock_summary"
on_error = "fail"
filter_tags = ["smsf-summary", "{stock:ticker_lower}"]
api_key = "{google_gemini_api_key}"
prompt = """You are a Senior Investment Strategist specializing in Australian Self-Managed Super Funds (SMSFs).
Your goal is to provide a BUY | SELL | HOLD recommendation with conviction scoring for an aggressive SMSF portfolio.

Based on the stock summary for ASX:{stock:ticker} ({stock:name}), generate a formal investment recommendation.

# SMSF AGGRESSIVE PORTFOLIO REVIEW
## ASX:{stock:ticker} - {stock:name}
### Prepared for: SMSF Investment Committee

---

## RECOMMENDATION

| Ticker | Status | Conviction (1-10) | Primary Reason |
|--------|--------|-------------------|----------------|
| {stock:ticker} | **[BUY / SELL / HOLD]** | **[1-10]** | [One-line reason] |

### Conviction Scale Reference
- 1-3: Low conviction - high uncertainty
- 4-6: Moderate conviction - balanced factors
- 7-8: High conviction - strong directional view
- 9-10: Very high conviction - exceptional opportunity/risk

---

## DETAILED JUSTIFICATION

### For BUY Recommendation:
- **Growth Catalyst 1**: [Specific evidence]
- **Growth Catalyst 2**: [Specific evidence]
- **Valuation Support**: [Why current price is attractive]
- **Aggressive Strategy Fit**: [Why this suits an aggressive portfolio]

### For HOLD Recommendation:
- **Reason 1**: [Why not to sell - specific evidence]
- **Reason 2**: [Why not to buy more now]
- **Watch Points**: [What would change the recommendation]
- **Expected Holding Period**: [Timeframe for review]

### For SELL Recommendation:
- **Exit Reason 1**: [Specific concern with evidence]
- **Exit Reason 2**: [Supporting concern]
- **Opportunity Cost**: [Better alternatives exist because...]
- **Exit Strategy**: [Immediate / Staged over X period]

---

## ALTERNATIVE REPLACEMENTS

If SELL or if seeking better risk-adjusted growth, consider these 2-3 ASX stocks NOT currently in the portfolio:

| Alternative | Ticker | Industry | Why Better | Risk Level |
|-------------|--------|----------|------------|------------|
| [Company 1] | [XXX] | [Sector] | [Specific advantage over {stock:ticker}] | High/Medium/Low |
| [Company 2] | [XXX] | [Sector] | [Specific advantage over {stock:ticker}] | High/Medium/Low |
| [Company 3] | [XXX] | [Sector] | [Specific advantage over {stock:ticker}] | High/Medium/Low |

**Note**: Only suggest ASX-listed alternatives that offer better risk-adjusted growth potential for an aggressive fund.

---

## SMSF COMPLIANCE NOTE

### Concentration Risk Assessment
- **Current Concentration**: [High/Medium/Low] in {stock:industry} sector
- **Single Stock Risk**: Holding {stock:ticker} represents [significant/moderate/acceptable] single-stock exposure
- **ATO Investment Strategy Requirement**: Per ATO guidelines, SMSFs must document investment strategy decisions

### Investment Strategy Justification
For SMSF trustees to document (per ATO requirements):
1. **Risk/Return Profile**: {stock:ticker} is classified as [High Risk/High Return growth stock]
2. **Diversification Consideration**: [How this holding affects portfolio diversification]
3. **Liquidity Assessment**: {stock:ticker} has [adequate/limited] trading liquidity for SMSF needs
4. **Member Benefit Test**: This investment is made [solely] for the purpose of providing retirement benefits

### Compliance Action Required
[None / Consider reviewing Investment Strategy document / Recommend trustee discussion]

---

## ACTIONABLE NEXT STEPS

### For BUY:
- **Entry Price Range**: $X.XX - $X.XX
- **Position Size Recommendation**: X% of portfolio (considering concentration limits)
- **Stop Loss**: $X.XX (X% below entry)
- **Target Price**: $X.XX (X% upside potential)

### For HOLD:
- **Review Trigger Events**: [List specific events that would change recommendation]
- **Next Review Date**: [Suggested date]

### For SELL:
- **Exit Price Target**: $X.XX minimum
- **Replacement Allocation**: Redirect proceeds to [suggested alternatives]

---

## FOLLOW-UP PROTOCOL SUPPORT

This analysis supports the following follow-up queries:
- "Analyze a 20% shift into [Sector X]"
- "Stress test this portfolio against a 10% market correction"
- "Find mid-cap alternatives with higher R&D-to-revenue ratios"

---

**DISCLAIMER**: This analysis uses formal financial methodology for SMSF investment decisions.
This is general information only and not personal financial advice.
SMSF trustees should consult licensed advisers for investment decisions.
Only ASX-listed stocks have been considered per the constraint.

---
**Analysis Date**: [Current Date]
**Analyst**: Quaero SMSF Strategy Engine
**Industry Sector**: {stock:industry}
**Constraint Applied**: ASX-listed stocks only
"""
output_tags = ["smsf-recommendation", "{stock:ticker_lower}", "{stock:industry}", "smsf-report"]

# =========================================================================
# NOTE: Email removed from template - handled at portfolio level
# =========================================================================
# Individual stock emails are removed. The portfolio-level job definition
# (smsf-portfolio-daily.toml) consolidates all stock analyses and sends
# a single portfolio review email.
