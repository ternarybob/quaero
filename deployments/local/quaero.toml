# Quaero Configuration
# ====================
#
# This file contains ONLY user-facing configuration settings.
# Technical parameters (cache sizes, timeouts, dimensions, etc.) have sensible
# defaults hardcoded in the application and should not be modified unless you
# are debugging or have specific requirements.
#
# Configuration Load Order (priority from lowest to highest):
#   1. Defaults (hardcoded in application)
#   2. TOML file (this file)
#   3. Environment variables (QUAERO_*)
#   4. Command line flags (--port, --host, --config)
#
# Only uncomment settings you want to override from defaults.

# =============================================================================
# Environment Configuration
# =============================================================================
# Controls environment mode: "development" or "production"
# Production mode rejects test URLs (localhost, 127.0.0.1, etc.) for safety
# Default: development (allows test URLs)
# Env vars: QUAERO_ENV, GO_ENV (highest priority)

environment = "development" # "development" or "production"

# =============================================================================
# Delete on Startup Settings
# =============================================================================
# Controls which data categories to delete at startup before loading configuration.
# This ensures a clean slate by removing stale data from previous runs.
#
# Valid values (array):
#   - "settings"  : Clear KV pairs, connectors, and job definitions
#   - "jobs"      : Clear job definitions only
#   - "queue"     : Clear all queue jobs/execution state
#   - "documents" : Clear all documents
#
# Runtime Reload:
# - Configuration can be reloaded at runtime via Settings > Danger Zone > Reload Configuration
# - The reload UI provides a checkbox to optionally clear configuration before reloading
#
# Default: [] (delete nothing - preserves all existing data)
#
# Examples:
#   delete_on_startup = ["settings", "queue"]  # Clear settings and queue on startup
#   delete_on_startup = ["queue"]              # Clear only queue jobs
#   delete_on_startup = []                     # Delete nothing (default)

# delete_on_startup = []

# =============================================================================
# Server Configuration
# =============================================================================
# Defaults: port=8080, host="localhost"
# CLI flags: --port, --host (highest priority)
# Env vars: QUAERO_SERVER_PORT, QUAERO_SERVER_HOST

# [server]
# port = 8080  # Uncomment to override default

# =============================================================================
# Storage Configuration
# =============================================================================
# Defaults: path="./data", images="./data/images", attachments="./data/attachments"
# Env vars: QUAERO_BADGER_PATH

# [storage.badger]
# path = "./data"  # Uncomment to override default

# [storage.filesystem]
# images = "./data/images"  # Uncomment to override default

# =============================================================================
# Google Places API Configuration
# =============================================================================
# Configure Google Places API for location-based search functionality.
# Get your API key from: https://console.cloud.google.com/apis/credentials
# Defaults: max_results_per_search=20, request_timeout=30s, rate_limit=1s
# Env var: QUAERO_PLACES_API_KEY

# [places_api]
# api_key = "YOUR_GOOGLE_PLACES_API_KEY"  # Required for places search jobs

# =============================================================================
# Gemini Configuration (Google Gemini API)
# =============================================================================
# Configure Google Gemini API for AI operations (agents, chat, summaries).
# Requires Google Gemini API key from: https://aistudio.google.com/app/apikey
#
# IMPORTANT: Gemini services require a valid API key. No offline fallback is available.
# If the API key is missing or invalid, operations will fail immediately.
#
# Thinking Levels:
# - NONE/MINIMAL: No extended thinking (fastest)
# - LOW: Light reasoning
# - NORMAL: Standard reasoning (default)
# - HIGH: Deep reasoning (slowest, most thorough)
#
# Jobs can override model and thinking in step config:
#   model = "gemini-2.5-flash-preview-05-20"  # Explicit model override
#   thinking_level = "HIGH"                    # Deep reasoning for complex analysis
#
# Defaults: model="gemini-3-flash-preview", thinking="NORMAL",
#           max_turns=10, timeout="5m", temperature=0.7
# Env vars: QUAERO_GEMINI_API_KEY, QUAERO_GEMINI_MODEL, QUAERO_GEMINI_THINKING,
#           QUAERO_GEMINI_MAX_TURNS, QUAERO_GEMINI_TIMEOUT, QUAERO_GEMINI_TEMPERATURE

# [gemini]
# api_key = "YOUR_GOOGLE_GEMINI_API_KEY"  # Required for all AI operations
# model = "gemini-3-flash-preview"        # Model for AI operations
# thinking = "NORMAL"                     # Default thinking level
# max_turns = 10                          # Maximum agent conversation turns
# timeout = "5m"                          # Operation timeout
# temperature = 0.7                       # Completion temperature (0.0-1.0)

# =============================================================================
# Claude Configuration (Anthropic API)
# =============================================================================
# Configure Anthropic Claude API for AI operations.
# Requires Anthropic API key from: https://console.anthropic.com/
#
# IMPORTANT: Claude services require a valid API key. No offline fallback is available.
# If the API key is missing or invalid, operations will fail immediately.
#
# Thinking Levels:
# - NORMAL: Standard reasoning (default)
# - HIGH: Deep reasoning for complex analysis
#
# Jobs can specify the model in step config:
#   model = "claude-sonnet-4-20250514"           # Explicit Claude model
#   model = "claude/claude-sonnet-4-20250514"    # With provider prefix
#   thinking_level = "HIGH"                      # Deep reasoning
#
# Defaults: model="claude-haiku-3-5-20241022", thinking="NORMAL",
#           max_tokens=8192, timeout="5m", temperature=0.7
# Env vars: ANTHROPIC_API_KEY, QUAERO_CLAUDE_API_KEY, QUAERO_CLAUDE_MODEL,
#           QUAERO_CLAUDE_THINKING, QUAERO_CLAUDE_MAX_TOKENS,
#           QUAERO_CLAUDE_TIMEOUT, QUAERO_CLAUDE_TEMPERATURE

# [claude]
# api_key = "YOUR_ANTHROPIC_API_KEY"       # Required for Claude operations
# model = "claude-haiku-3-5-20241022"      # Model for AI operations
# thinking = "NORMAL"                      # Default thinking level
# max_tokens = 8192                        # Maximum tokens in response
# timeout = "5m"                           # Operation timeout
# temperature = 0.7                        # Completion temperature (0.0-1.0)

# =============================================================================
# LLM Provider Configuration (Multi-Provider Support)
# =============================================================================
# Configure the default AI provider for operations.
# Individual jobs/steps can override by specifying a model with provider prefix.
#
# Supported providers:
# - gemini: Google Gemini API (default)
# - claude: Anthropic Claude API
#
# Model selection in jobs:
# - "gemini-3-flash-preview" or "gemini/gemini-3-flash-preview" -> Uses Gemini
# - "claude-sonnet-4-20250514" or "claude/claude-sonnet-4-20250514" -> Uses Claude
# - Empty or no model specified -> Uses default provider
#
# Defaults: default_provider="gemini"
# Env vars: QUAERO_LLM_DEFAULT_PROVIDER

# [llm]
# default_provider = "gemini"  # Default provider: "gemini" or "claude"

# =============================================================================
# Job Definitions Configuration
# =============================================================================
# Job definitions are user-defined workflows stored as TOML/JSON files.
# Place .toml or .json files in the definitions_dir to auto-load at startup.
#
# Supported job types:
# - crawler: Web crawling jobs (scrape websites, follow links, extract content)
# - places: Google Places API search jobs (find locations, get details)
# - agent: AI agent jobs (keyword extraction, summarization, classification)
# - custom: Custom workflow jobs (multi-step orchestration)
#
# Debug Mode:
# When enabled, workers collect timing metadata for each execution:
# - API call timing (external service calls)
# - JSON generation timing (data transformation)
# - Markdown conversion timing (output formatting)
# - AI source info (model used, token counts)
# - Total worker execution time
# This metadata is added to document metadata as "worker_debug".
#
# Default: definitions_dir="./job-definitions", debug=false
# Env vars: QUAERO_JOBS_DEFINITIONS_DIR, QUAERO_JOBS_DEBUG

[jobs]
definitions_dir = "./deployments/local/job-definitions"  # Load job definitions from local directory
# debug = false  # Enable worker debug metadata (timing, API calls, AI sources)

# =============================================================================
# Documentation Configuration
# =============================================================================
# Configure the documentation directory for reference files.
# Documentation files are used by the system for self-instruction,
# job creation guidance, and worker reference.
#
# The startup documentation job scans this directory and saves all
# matching files as documents for AI-assisted job creation.
#
# Default: dir="./docs", extensions=[".md"]
# Env var: QUAERO_DOCS_DIR

[docs]
dir = "./docs"            # Directory containing documentation files
extensions = [".md"]      # File extensions to scan (markdown by default)

# =============================================================================
# Variables Configuration
# =============================================================================
# Configure storage for user-defined variables (API keys, secrets, configuration values).
# Variables are loaded from TOML files in the variables directory at startup.
#
# TOML FILE FORMAT (stored in ./variables/*.toml):
#   [[keys]]
#   key = "variable-name"
#   value = "your-secret-value"      # Required
#   description = "Optional description"  # Optional
#
# USAGE:
#   - Variables can be referenced in config using placeholder syntax: {variable-name}
#   - View and manage in UI: /settings?a=kv
#   - Values are masked in logs and UI for security
#
# Example: See bin/variables/example-variables.toml
#
# Default storage location: ./variables/ directory
# File format: Any *.toml file in the variables directory
# Env var: QUAERO_VARIABLES_DIR

# [variables]
# dir = "./variables"  # Uncomment to override default

# =============================================================================
# Crawler Configuration (Firecrawl-style HTML Scraping)
# =============================================================================
# Configure HTML scraping behavior for web page crawling.
# Follows Firecrawl architecture: scrape pages, convert to markdown, extract metadata.
#
# Defaults: user_agent="Quaero/1.0 (Web Crawler)", max_concurrency=3,
#           request_delay=1s, random_delay=500ms, request_timeout=30s,
#           max_body_size=10MB, max_depth=5, output_format="markdown"
# Env vars: QUAERO_CRAWLER_USER_AGENT, QUAERO_CRAWLER_MAX_CONCURRENCY, etc.

# [crawler]
# user_agent = "Quaero/1.0 (Web Crawler)"  # Uncomment to override default
# max_concurrency = 3                       # Uncomment to override default

# =============================================================================
# Logging Configuration
# =============================================================================
# Configure application logging and real-time UI event publishing.
#
# Log Flow Architecture:
#   Services → Arbor Logger → LogService → [Database + EventService]
#                                             ↓           ↓
#                                        (all logs)   (filtered)
#                                                        ↓
#                                                   WebSocket → UI
#
# Key Concept: LogService filters logs and publishes to EventService.
# Only logs >= min_event_level are published as events to the UI.
# All logs (regardless of level) are saved to the database for auditing.
#
# Defaults: level="info", format="text", output=["stdout","file"], min_event_level="info"
# Env vars: QUAERO_LOG_LEVEL, QUAERO_LOG_FORMAT, QUAERO_LOG_MIN_EVENT_LEVEL

# [logging]
# level = "info"            # Uncomment to override default (debug, info, warn, error)
# min_event_level = "info"  # Minimum log level to publish as real-time events to UI
#                           # Example: Set to "warn" to only show warnings/errors in UI
#                           # Example: Set to "debug" to show all logs in UI (verbose)

# =============================================================================
# WebSocket Event Broadcasting Configuration
# =============================================================================
# Configure server-side filtering for real-time event broadcasting to browser UI.
# Events are filtered before broadcasting to reduce client load and network traffic.
#
# Defaults: allowed_events=[] (all events), min_level="info",
#           throttle_intervals={crawl_progress:1s, job_spawn:500ms}
# Env vars: QUAERO_WEBSOCKET_ALLOWED_EVENTS, QUAERO_WEBSOCKET_THROTTLE_CRAWL_PROGRESS,
#           QUAERO_WEBSOCKET_THROTTLE_JOB_SPAWN

# [websocket]
# allowed_events = []  # Empty list allows all events (default)
# min_level = "info"   # Minimum log level for WebSocket events (default: info)

# [websocket.throttle_intervals]
# crawl_progress = "1s"   # Uncomment to override default
# job_spawn = "500ms"     # Uncomment to override default

# =============================================================================
# Markets Configuration
# =============================================================================
# Configure default market/exchange settings for ticker parsing.
#
# Ticker Format Support:
# - "ASX:GNP" or "ASX.GNP" -> Exchange="ASX", Code="GNP" (explicit exchange)
# - "GNP" -> Exchange=default, Code="GNP" (uses default exchange below)
#
# EODHD Transposition:
# Our format: EXCHANGE.CODE (e.g., "ASX.GNP") or EXCHANGE:CODE (e.g., "ASX:GNP")
# EODHD format: CODE.SUFFIX (e.g., "GNP.AU")
# The EODHDSymbol() method handles this conversion automatically.
#
# Default: ASX (Australian Securities Exchange)
# Env var: QUAERO_MARKETS_DEFAULT

[markets]
default = "ASX"  # Default exchange when ticker has no prefix

