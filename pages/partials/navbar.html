<nav data-role="appbar" data-expand-point="md" class="pos-fixed" role="navigation" aria-label="main navigation">
    <a href="/" class="brand no-hover"><span class="text-bold">Quaero</span></a>

    <div class="app-bar-container ml-auto mr-auto">
        <ul class="app-bar-menu">
            <li><a href="/" {{if eq .Page "home" }}class="active" {{end}}>HOME</a></li>
            <li><a href="/auth" {{if eq .Page "auth" }}class="active" {{end}}>AUTHENTICATION</a></li>
            <li><a href="/sources" {{if eq .Page "sources" }}class="active" {{end}}>SOURCES</a></li>
            <li><a href="/jobs" {{if eq .Page "jobs" }}class="active" {{end}}>JOBS</a></li>
            <li><a href="/documents" {{if eq .Page "documents" }}class="active" {{end}}>DOCUMENTS</a></li>
            <li><a href="/chat" {{if eq .Page "chat" }}class="active" {{end}}>CHAT</a></li>
            <li><a href="/config" {{if or (eq .Page "settings" ) (eq .Page "config" )}}class="active" {{end}}>SETTINGS</a></li>
        </ul>
    </div>

    <div class="app-bar-container ml-auto">
        <span class="badge success status-text">ONLINE</span>
    </div>
</nav>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Navbar status indicator using shared WebSocket manager
        function updateNavbarStatus(online) {
            const statusText = document.querySelector('.status-text');
            if (statusText) {
                if (online) {
                    statusText.classList.remove('danger');
                    statusText.classList.add('success');
                    statusText.textContent = 'ONLINE';
                } else {
                    statusText.classList.remove('success');
                    statusText.classList.add('danger');
                    statusText.textContent = 'OFFLINE';
                }
            }
        }

        // Subscribe to connection changes
        if (typeof WebSocketManager !== 'undefined') {
            WebSocketManager.onConnectionChange(updateNavbarStatus);
            console.log('[Navbar] WebSocket subscription established');
        } else {
            console.error('[Navbar] WebSocketManager not loaded');
        }

        // Dynamic body padding based on AppBar height
        function updateBodyPadding() {
            const appbar = document.querySelector('[data-role="appbar"]');
            if (appbar) {
                const height = appbar.getBoundingClientRect().height;
                document.body.style.paddingTop = height + 'px';
            }
        }

        // Initial padding calculation after Metro enhances the AppBar
        setTimeout(updateBodyPadding, 100);

        // Debounced resize handler
        let resizeTimer;
        window.addEventListener('resize', function () {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(updateBodyPadding, 250);
        });
    });
</script>