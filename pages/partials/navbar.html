<header class="app-header">
    <div class="app-header-content">
        <nav class="app-header-nav" x-data="{ mobileMenuOpen: false }">
            <a href="/" class="brand"><span class="text-bold">Quaero</span></a>
            <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="nav-links" :class="{ 'mobile-open': mobileMenuOpen }">
                <a href="/" {{if eq .Page "home"}}class="active"{{end}}>HOME</a>
                <a href="/auth" {{if eq .Page "auth"}}class="active"{{end}}>AUTHENTICATION</a>
                <a href="/sources" {{if eq .Page "sources"}}class="active"{{end}}>SOURCES</a>
                <a href="/jobs" {{if eq .Page "jobs"}}class="active"{{end}}>JOBS</a>
                <a href="/documents" {{if eq .Page "documents"}}class="active"{{end}}>DOCUMENTS</a>
                <a href="/chat" {{if eq .Page "chat"}}class="active"{{end}}>CHAT</a>
                <a href="/config" {{if or (eq .Page "settings") (eq .Page "config")}}class="active"{{end}}>SETTINGS</a>
            </div>
        </nav>
        <span class="label label-success status-text">ONLINE</span>
    </div>
</header>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Navbar status indicator using shared WebSocket manager
        function updateNavbarStatus(online) {
            const statusText = document.querySelector('.status-text');
            if (statusText) {
                if (online) {
                    statusText.classList.remove('label-error');
                    statusText.classList.add('label-success');
                    statusText.textContent = 'ONLINE';
                } else {
                    statusText.classList.remove('label-success');
                    statusText.classList.add('label-error');
                    statusText.textContent = 'OFFLINE';
                }
            }
        }

        // Subscribe to connection changes
        if (typeof WebSocketManager !== 'undefined') {
            WebSocketManager.onConnectionChange(updateNavbarStatus);
            console.log('[Navbar] WebSocket subscription established');
        } else {
            console.error('[Navbar] WebSocketManager not loaded');
        }
    });
</script>
