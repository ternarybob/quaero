# Signal Workers Integration Test
# Tests signal computation pipeline: stock collector -> signal computer
#
# This job definition uses exchange-qualified tickers (ASX:XXX format)
# for all ticker data collection and processing.

id = "signal-workers-test"
name = "Signal Workers Integration Test"
type = "orchestrator"
description = "Tests ASX stock data collection and signal computation pipeline"
tags = ["test", "signals", "asx"]
schedule = ""
timeout = "30m"
enabled = true
auto_start = false

[config]
# Cache disabled for testing
cache_type = "none"

# Test stocks using exchange-qualified format
# - ASX:GNP - GenusPlus Group Ltd (infrastructure)
# - ASX:BCN - Beacon Minerals (mining)
# - ASX:MYG - Mayfield Childcare (services)
variables = [
    { ticker = "ASX:GNP" },
    { ticker = "ASX:BCN" },
    { ticker = "ASX:MYG" },
]

# Step 1: Collect stock data for each ticker
[step.collect_stock_data]
type = "market_fundamentals"
description = "Fetch comprehensive stock data from EODHD"
on_error = "continue"
period = "Y2"
output_tags = ["compute_signals"]

# Step 2: Compute signals from collected data
[step.compute_signals]
type = "signal_analysis"
depends = "collect_stock_data"
description = "Compute PBAS, VLI, Regime, and other signals"
on_error = "fail"
output_tags = ["test-signals"]
