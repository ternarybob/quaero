
⚠ Service not pre-started (tests using SetupTestEnvironment will start their own)
   Note: service not accessible at http://localhost:18085: Get "http://localhost:18085": dial tcp [::1]:18085: connectex: No connection could be made because the target machine actively refused it.

=== RUN   TestNewsCrawlerJobExecution
    setup.go:824: === RUN TestNewsCrawlerJobExecution
    setup.go:824: Test environment ready, service running at: http://localhost:18085
    setup.go:824: Results directory: ..\results\ui\news-20251109-124319\TestNewsCrawlerJobExecution
    setup.go:824: Step 1: Navigating to jobs page to find news-crawler...
    setup.go:824: ✓ Jobs page loaded
    setup.go:824: ✓ News Crawler job found in job definitions list
    setup.go:824: Step 2: Executing the News Crawler job...
    setup.go:824: ✓ News Crawler job execution triggered
    setup.go:824: Step 3: Navigating to queue page to monitor execution...
    setup.go:824: ✓ Jobs loaded successfully (1 jobs)
    setup.go:824: Step 4: Monitoring News Crawler job execution...
    setup.go:824: ✓ News Crawler job found in queue
    setup.go:824:   Job ID: 4c9d1110-6c4a-4a2f-91ca-d9c2d29e689b
    setup.go:824:   Initial Status: Completed
    setup.go:824:   Current Status: Completed
    setup.go:824:   Job reached terminal state: Completed
    setup.go:824: Step 4a: Validating progress text format...
    setup.go:824:   Progress text: 
    setup.go:824:   INFO: Progress text is empty (no child jobs spawned)
    setup.go:824: Step 4b: Validating document count from queue page...
    setup.go:824: ✓ Document count from queue page: 2 Documents
    setup.go:824: ❌ FAILURE: Queue page shows 2 documents (expected <= 1)
    setup.go:824:   This indicates max_pages=1 configuration is not being respected
    crawler_test.go:397: Queue page document count should be <= 1 (max_pages=1), got 2
    setup.go:824: Step 5: Navigating to job details page to verify configuration and logs...
    setup.go:824: ✓ Successfully navigated to job details page
    setup.go:824: Step 5a: Verifying crawler configuration display...
    setup.go:824: WARNING: Crawler Configuration section not visible (config available in logs)
    setup.go:824: Step 5b: Switching to Output tab to verify logs...
    setup.go:824: ✓ Switched to Output tab
    setup.go:824: ✓ Retrieved job logs (470 characters)
    setup.go:824: Step 5b-1: Verifying job logs are visible in the UI...
    setup.go:824:   Terminal visible: true
    setup.go:824:   Terminal height: 0px
    setup.go:824:   Has visible text: true
    setup.go:824: ❌ FAILURE: Job logs are not properly rendered in the UI
    setup.go:824:   Expected: Log content displayed in terminal with visible height
    setup.go:824:   Actual: Terminal element exists but logs are not properly rendered
    setup.go:824:   Terminal display: visible=true, height=0px (expected >=50px), content length=470
    crawler_test.go:593: Job logs should be visible in the Output tab with terminal height >= 50px (got 0px)
    setup.go:824:   ✓ Found start_urls configuration in logs
    setup.go:824:   - Missing optional stockhead.com.au URL in logs
    setup.go:824:   ✓ Found abc.net.au URL in logs
    setup.go:824:   ✓ Found source type configuration in logs
    setup.go:824:   ✓ Found job definition ID in logs
    setup.go:824:   ✓ Found max depth configuration in logs
    setup.go:824:   ✓ Found crawl step configuration in logs
    setup.go:824: ✓ Logs contain expected crawler configuration details (6/7 checks passed)
    setup.go:824: Log preview (first 1000 chars): {
          "base_url": "",
          "enabled": true,
          "job_definition_id": "news-crawler",
          "schedule": "",
          "source_type": "web",
          "step_1_crawl": {
            "concurrency": 5,
            "exclude_patterns": [
              "login",
              "logout",
              "admin"
            ],
            "follow_links": true,
            "include_patterns": [
              "article",
              "news",
              "post"
            ],
            "max_depth": 1,
            "max_pages": 1,
            "start_urls": [
              "https://www.abc.net.au/news"
            ]
          },
          "timeout": "30m"
        }
    setup.go:824: Step 6: Verifying enhanced queue page features for crawler jobs...
    setup.go:824: Step 7: Navigating to Documents page to verify document count...
    setup.go:824: ✓ Documents page loaded
    setup.go:824: Step 7a: Checking document count from UI...
    setup.go:824: WARNING: Error reading document count from UI: Total documents stat not found in UI
    setup.go:824: Step 7b: Verifying document collection via API...
    setup.go:824: ✓ Document count from API: 1 documents
    setup.go:824: ✅ SUCCESS: Exactly 1 document collected (matches max_pages=1 in news-crawler.toml)
    setup.go:824: ✓ Job logs indicate document storage occurred (1 references)
    setup.go:824: ✅ News Crawler job execution test completed successfully
    setup.go:824: --- FAIL: TestNewsCrawlerJobExecution (28.81s)
--- FAIL: TestNewsCrawlerJobExecution (30.32s)
FAIL
Cleaning up test resources...
✓ Cleanup complete
exit status 1
FAIL	github.com/ternarybob/quaero/test/ui	30.706s
